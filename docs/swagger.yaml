definitions:
  types.Code:
    enum:
    - 0
    - 1001
    - 1002
    - 1003
    - 1004
    - 1005
    type: integer
    x-enum-varnames:
    - CodeSuccess
    - CodeRunning
    - CodeFailed
    - CodeNoData
    - CodePending
    - CodePaused
  types.SBase-any:
    properties:
      code:
        allOf:
        - $ref: '#/definitions/types.Code'
        example: 255
      data: {}
      msg:
        example: message
        type: string
      timestamp:
        type: integer
    type: object
  types.SBase-types_SFileListRes:
    properties:
      code:
        allOf:
        - $ref: '#/definitions/types.Code'
        example: 255
      data:
        $ref: '#/definitions/types.SFileListRes'
      msg:
        example: message
        type: string
      timestamp:
        type: integer
    type: object
  types.SBase-types_SHealthyz:
    properties:
      code:
        allOf:
        - $ref: '#/definitions/types.Code'
        example: 255
      data:
        $ref: '#/definitions/types.SHealthyz'
      msg:
        example: message
        type: string
      timestamp:
        type: integer
    type: object
  types.SBase-types_SLogsRes:
    properties:
      code:
        allOf:
        - $ref: '#/definitions/types.Code'
        example: 255
      data:
        items:
          $ref: '#/definitions/types.SLogRes'
        type: array
      msg:
        example: message
        type: string
      timestamp:
        type: integer
    type: object
  types.SBase-types_SPool:
    properties:
      code:
        allOf:
        - $ref: '#/definitions/types.Code'
        example: 255
      data:
        $ref: '#/definitions/types.SPool'
      msg:
        example: message
        type: string
      timestamp:
        type: integer
    type: object
  types.SBase-types_SProjectRes:
    properties:
      code:
        allOf:
        - $ref: '#/definitions/types.Code'
        example: 255
      data:
        $ref: '#/definitions/types.SProjectRes'
      msg:
        example: message
        type: string
      timestamp:
        type: integer
    type: object
  types.SBase-types_SStepRes:
    properties:
      code:
        allOf:
        - $ref: '#/definitions/types.Code'
        example: 255
      data:
        $ref: '#/definitions/types.SStepRes'
      msg:
        example: message
        type: string
      timestamp:
        type: integer
    type: object
  types.SBase-types_SStepsRes:
    properties:
      code:
        allOf:
        - $ref: '#/definitions/types.Code'
        example: 255
      data:
        items:
          $ref: '#/definitions/types.SStepRes'
        type: array
      msg:
        example: message
        type: string
      timestamp:
        type: integer
    type: object
  types.SBase-types_STaskCreateRes:
    properties:
      code:
        allOf:
        - $ref: '#/definitions/types.Code'
        example: 255
      data:
        $ref: '#/definitions/types.STaskCreateRes'
      msg:
        example: message
        type: string
      timestamp:
        type: integer
    type: object
  types.SBase-types_STaskListDetailRes:
    properties:
      code:
        allOf:
        - $ref: '#/definitions/types.Code'
        example: 255
      data:
        $ref: '#/definitions/types.STaskListDetailRes'
      msg:
        example: message
        type: string
      timestamp:
        type: integer
    type: object
  types.SBase-types_STaskRes:
    properties:
      code:
        allOf:
        - $ref: '#/definitions/types.Code'
        example: 255
      data:
        $ref: '#/definitions/types.STaskRes'
      msg:
        example: message
        type: string
      timestamp:
        type: integer
    type: object
  types.SBase-types_SVersion:
    properties:
      code:
        allOf:
        - $ref: '#/definitions/types.Code'
        example: 255
      data:
        $ref: '#/definitions/types.SVersion'
      msg:
        example: message
        type: string
      timestamp:
        type: integer
    type: object
  types.SFileListRes:
    properties:
      files:
        items:
          $ref: '#/definitions/types.SFileRes'
        type: array
      total:
        type: integer
    type: object
  types.SFileRes:
    properties:
      is_dir:
        type: boolean
      mod_time:
        type: integer
      mode:
        type: string
      name:
        type: string
      path:
        type: string
      size:
        type: integer
    type: object
  types.SHealthyz:
    properties:
      client:
        type: string
      server:
        type: string
      state:
        type: string
    type: object
  types.SLogRes:
    properties:
      content:
        description: 内容
        type: string
      line:
        description: 行号
        type: integer
      timestamp:
        description: 时间戳
        type: integer
    type: object
  types.SPageRes:
    properties:
      current:
        description: 当前页
        type: integer
      size:
        description: 页大小
        type: integer
      total:
        description: 总页数
        type: integer
    type: object
  types.SPool:
    properties:
      running:
        type: integer
      size:
        example: 30
        type: integer
      total:
        type: integer
      waiting:
        type: integer
    required:
    - size
    type: object
  types.SProjectCreateReq:
    properties:
      content:
        type: string
      description:
        type: string
      disable:
        type: boolean
      name:
        type: string
      type:
        type: string
    required:
    - content
    - name
    - type
    type: object
  types.SProjectRes:
    properties:
      content:
        type: string
      description:
        type: string
      disable:
        type: boolean
      name:
        type: string
      type:
        type: string
    type: object
  types.SProjectUpdateReq:
    properties:
      content:
        type: string
      description:
        type: string
      disable:
        type: boolean
      type:
        type: string
    required:
    - content
    - type
    type: object
  types.SStepReq:
    properties:
      content:
        description: 步骤内容
        example: sleep 10
        type: string
      depends:
        description: 步骤依赖
        example:
        - ""
        items:
          type: string
        type: array
      description:
        description: 步骤描述
        example: script.ps1
        type: string
      disable:
        description: 是否禁用
        example: false
        type: boolean
      env:
        additionalProperties:
          type: string
        description: 步骤环境变量
        example:
          key: value
          key1: value1
        type: object
      name:
        description: 步骤名称
        example: script.ps1
        type: string
      timeout:
        description: 步骤超时时间
        example: 3m
        type: string
      type:
        description: 步骤超时时间
        example: powershell
        type: string
    type: object
  types.SStepRes:
    properties:
      code:
        description: 步骤退出码
        type: integer
      content:
        description: 步骤内容
        type: string
      depends:
        description: 步骤依赖
        items:
          type: string
        type: array
      description:
        description: 步骤描述
        type: string
      disable:
        description: 是否禁用
        type: boolean
      env:
        additionalProperties:
          type: string
        description: 步骤环境变量
        type: object
      msg:
        description: 步骤信息
        type: string
      name:
        description: 步骤名称
        type: string
      state:
        description: 步骤状态
        type: string
      time:
        allOf:
        - $ref: '#/definitions/types.STimeRes'
        description: 时间
      timeout:
        description: 步骤超时时间
        type: string
      type:
        description: 步骤类型
        type: string
    type: object
  types.STaskCreateRes:
    properties:
      count:
        description: 步骤数量
        type: integer
      name:
        description: 任务名称
        type: string
    type: object
  types.STaskListDetailRes:
    properties:
      page:
        allOf:
        - $ref: '#/definitions/types.SPageRes'
        description: 分页
      tasks:
        description: 任务列表
        items:
          $ref: '#/definitions/types.STaskRes'
        type: array
    type: object
  types.STaskReq:
    properties:
      async:
        description: 是否异步执行
        example: false
        type: boolean
      description:
        description: 任务描述
        type: string
      disable:
        description: 是否禁用
        example: false
        type: boolean
      env:
        additionalProperties:
          type: string
        description: 任务环境变量
        example:
          key: value
          key1: value1
        type: object
      name:
        description: 任务名称
        example: task_name
        type: string
      node:
        description: Node 执行节点
        example: ""
        type: string
      step:
        description: 任务步骤
        items:
          $ref: '#/definitions/types.SStepReq'
        type: array
      timeout:
        description: 任务超时时间
        example: 24h
        type: string
    type: object
  types.STaskRes:
    properties:
      count:
        description: 步骤数量
        type: integer
      description:
        description: 任务描述
        type: string
      disable:
        description: 是否禁用
        type: boolean
      env:
        additionalProperties:
          type: string
        description: 任务环境变量
        type: object
      msg:
        description: 任务信息
        type: string
      name:
        description: 任务名称
        type: string
      node:
        description: 节点名称
        type: string
      state:
        description: 任务状态
        type: string
      time:
        allOf:
        - $ref: '#/definitions/types.STimeRes'
        description: 时间
      timeout:
        description: 任务超时时间
        type: string
    type: object
  types.STimeRes:
    properties:
      end:
        description: 结束时间
        type: string
      start:
        description: 开始时间
        type: string
    type: object
  types.SVersion:
    properties:
      build_time:
        type: string
      git:
        $ref: '#/definitions/types.SVersionGit'
      go:
        $ref: '#/definitions/types.SVersionGO'
      user:
        $ref: '#/definitions/types.SVersionUser'
      version:
        type: string
    type: object
  types.SVersionGO:
    properties:
      arch:
        type: string
      os:
        type: string
      version:
        type: string
    type: object
  types.SVersionGit:
    properties:
      branch:
        type: string
      commit:
        type: string
      url:
        type: string
    type: object
  types.SVersionUser:
    properties:
      email:
        type: string
      name:
        type: string
    type: object
info:
  contact:
    name: AutoExecFlow
    url: https://github.com/xmapst/AutoExecFlow/issues
  description: |-
    An `API` for cross-platform custom orchestration of execution steps
    without any third-party dependencies. Based on `DAG`, it implements the scheduling
    function of sequential execution of dependent steps and concurrent execution of
    non-dependent steps. <br /><br /> It provides `API` remote operation mode, batch
    execution of `Shell` , `Powershell` , `Python` and other commands, and easily
    completes common management tasks such as running automated operation and maintenance
    scripts, polling processes, installing or uninstalling software, updating applications,
    and installing patches.
  license:
    name: GPL-3.0
    url: https://github.com/xmapst/AutoExecFlow/blob/main/LICENSE
  title: Auto Exec Flow
  version: "1.0"
paths:
  /api/v1/event:
    get:
      consumes:
      - application/json
      description: 订阅系统事件, SSE
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/types.SBase-any'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/types.SBase-any'
      summary: 事件
      tags:
      - 事件
  /api/v1/pool:
    get:
      consumes:
      - application/json
      description: 获取工作池信息
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/types.SBase-types_SPool'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/types.SBase-any'
      summary: 详情
      tags:
      - 工作池
    post:
      consumes:
      - application/json
      description: 设置工作池大小
      parameters:
      - description: pool setting
        in: body
        name: setting
        required: true
        schema:
          $ref: '#/definitions/types.SPool'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/types.SBase-types_SPool'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/types.SBase-any'
      summary: 设置
      tags:
      - 工作池
  /api/v1/project:
    get:
      consumes:
      - application/json
      description: 获取项目列表, 支持WS长连接
      parameters:
      - default: 1
        description: 页码
        in: query
        name: page
        type: integer
      - default: 100
        description: 分页大小
        in: query
        name: size
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/types.SBase-types_STaskListDetailRes'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/types.SBase-any'
      summary: 列表
      tags:
      - 项目
    post:
      consumes:
      - application/json
      description: 创建项目
      parameters:
      - description: 项目内容
        in: body
        name: content
        required: true
        schema:
          $ref: '#/definitions/types.SProjectCreateReq'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/types.SBase-any'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/types.SBase-any'
      summary: 创建
      tags:
      - 项目
  /api/v1/project/{project}:
    delete:
      consumes:
      - application/json
      description: 删除项目
      parameters:
      - description: 项目名称
        in: path
        name: project
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/types.SBase-any'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/types.SBase-any'
      summary: 删除项目
      tags:
      - 项目
    get:
      consumes:
      - application/json
      description: 获取项目详情
      parameters:
      - description: 项目名称
        in: path
        name: project
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/types.SBase-types_SProjectRes'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/types.SBase-any'
      summary: 详情
      tags:
      - 项目
    post:
      consumes:
      - application/json
      description: 更新项目
      parameters:
      - description: 项目名称
        in: path
        name: project
        required: true
        type: string
      - description: 更新内容
        in: body
        name: content
        required: true
        schema:
          $ref: '#/definitions/types.SProjectUpdateReq'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/types.SBase-any'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/types.SBase-any'
      summary: 更新
      tags:
      - 项目
  /api/v1/project/{project}/build:
    get:
      consumes:
      - application/json
      description: 获取构建列表, 支持WS长连接
      parameters:
      - description: 项目名称
        in: path
        name: project
        required: true
        type: string
      - default: 1
        description: 页码
        in: query
        name: page
        type: integer
      - default: 100
        description: 分页大小
        in: query
        name: size
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/types.SBase-types_STaskListDetailRes'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/types.SBase-any'
      summary: 列表
      tags:
      - Build
  /api/v1/pty:
    get:
      consumes:
      - application/json
      description: Websocket的pty终端
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/types.SBase-any'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/types.SBase-any'
      summary: 终端
      tags:
      - 系统
  /api/v1/task:
    get:
      consumes:
      - application/json
      description: 获取任务列表, 支持WS长连接
      parameters:
      - default: 1
        description: 页码
        in: query
        name: page
        type: integer
      - default: 100
        description: 分页大小
        in: query
        name: size
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/types.SBase-types_STaskListDetailRes'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/types.SBase-any'
      summary: 列表
      tags:
      - 任务
    post:
      consumes:
      - application/json
      description: 创建任务
      parameters:
      - description: 任务名称
        in: query
        name: name
        type: string
      - default: false
        description: 是否异步执行
        in: query
        name: async
        type: boolean
      - description: 执行超时时间
        in: query
        name: timeout
        type: string
      - collectionFormat: csv
        description: 任务环境变量
        in: query
        items:
          type: string
        name: env
        type: array
      - description: 步骤内容
        in: body
        name: steps
        required: true
        schema:
          items:
            $ref: '#/definitions/types.SStepReq'
          type: array
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/types.SBase-types_STaskCreateRes'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/types.SBase-any'
      summary: 创建
      tags:
      - 任务
  /api/v1/task/{task}:
    delete:
      consumes:
      - application/json
      description: 删除指定任务
      parameters:
      - description: 任务名称
        in: path
        name: task
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/types.SBase-any'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/types.SBase-any'
      summary: 删除
      tags:
      - 任务
    get:
      consumes:
      - application/json
      description: 获取指定任务的步骤列表, 支持WS长连接
      parameters:
      - description: 任务名称
        in: path
        name: task
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/types.SBase-types_SStepsRes'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/types.SBase-any'
      summary: 列表
      tags:
      - 步骤
    put:
      consumes:
      - application/json
      description: 管理任务, 支持暂停、恢复、终止、超时暂停自动恢复
      parameters:
      - description: 任务名称
        in: path
        name: task
        required: true
        type: string
      - default: paused
        description: 操作项
        enum:
        - paused
        - kill
        - pause
        - resume
        in: query
        name: action
        type: string
      - default: 1m
        description: 暂停多久, 如果没设置则需要手工恢复
        in: query
        name: duration
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/types.SBase-any'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/types.SBase-any'
      summary: 管理
      tags:
      - 任务
  /api/v1/task/{task}/step/{step}:
    get:
      consumes:
      - application/json
      description: 指定任务指定步骤的执行输出, 支持WS长连接
      parameters:
      - description: 任务名称
        in: path
        name: task
        required: true
        type: string
      - description: 步骤名称
        in: path
        name: step
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/types.SBase-types_SLogsRes'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/types.SBase-any'
      summary: 日志
      tags:
      - 步骤
    put:
      consumes:
      - application/json
      description: 管理指定任务的指定步骤, 支持暂停、恢复、终止、超时暂停自动恢复
      parameters:
      - description: 任务名称
        in: path
        name: task
        required: true
        type: string
      - description: 步骤名称
        in: path
        name: step
        required: true
        type: string
      - default: paused
        description: 操作项
        enum:
        - paused
        - kill
        - pause
        - resume
        in: query
        name: action
        type: string
      - default: 1m
        description: 暂停多久, 如果没设置则需要手工恢复
        in: query
        name: duration
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/types.SBase-any'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/types.SBase-any'
      summary: 管理
      tags:
      - 步骤
  /api/v1/task/{task}/workspace:
    delete:
      consumes:
      - application/json
      description: 删除指定目录或文件
      parameters:
      - description: 任务名称
        in: path
        name: task
        required: true
        type: string
      - description: 路径
        in: query
        name: path
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/types.SBase-any'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/types.SBase-any'
      summary: 删除
      tags:
      - 工作目录
    get:
      consumes:
      - application/json
      description: 获取目录列表或下载指定文件
      parameters:
      - description: 任务名称
        in: path
        name: task
        required: true
        type: string
      - description: 路径
        in: query
        name: path
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/types.SBase-types_SFileListRes'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/types.SBase-any'
      summary: 列表或下载
      tags:
      - 工作目录
    post:
      consumes:
      - multipart/form-data
      description: 上传文件或目录
      parameters:
      - description: 任务名称
        in: path
        name: task
        required: true
        type: string
      - description: 路径
        in: query
        name: path
        type: string
      - description: 文件
        in: formData
        name: files
        required: true
        type: file
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/types.SBase-any'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/types.SBase-any'
      summary: 上传
      tags:
      - 工作目录
  /api/v2/task:
    post:
      consumes:
      - application/json
      description: 创建任务
      parameters:
      - description: 任务内容
        in: body
        name: task
        required: true
        schema:
          $ref: '#/definitions/types.STaskReq'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/types.SBase-types_STaskCreateRes'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/types.SBase-any'
      summary: 创建
      tags:
      - 任务
  /api/v2/task/{task}:
    get:
      consumes:
      - application/json
      description: 获取任务详情
      parameters:
      - description: 任务名称
        in: path
        name: task
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/types.SBase-types_STaskRes'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/types.SBase-any'
      summary: 详情
      tags:
      - 任务
  /api/v2/task/{task}/step/{step}:
    get:
      consumes:
      - application/json
      description: 获取步骤详情
      parameters:
      - description: 任务名称
        in: path
        name: task
        required: true
        type: string
      - description: 步骤名称
        in: path
        name: step
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/types.SBase-types_SStepRes'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/types.SBase-any'
      summary: 详情
      tags:
      - 步骤
  /healthyz:
    get:
      consumes:
      - application/json
      description: 用于检测服务是否正常
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/types.SBase-types_SHealthyz'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/types.SBase-any'
      summary: 健康
      tags:
      - 默认
  /heartbeat:
    get:
      consumes:
      - application/json
      description: 用于判断服务是否正常
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            type: string
        "500":
          description: Internal Server Error
          schema:
            type: string
      summary: 心跳
      tags:
      - 默认
  /version:
    get:
      consumes:
      - application/json
      description: 获取版本信息
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/types.SBase-types_SVersion'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/types.SBase-any'
      summary: 版本
      tags:
      - 默认
swagger: "2.0"
